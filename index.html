<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>K‑Media Bias Directory (MVP)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="한국 언론사를 좌·중·우로 나눠 링크 모아보기 — 사용자가 직접 분류를 수정할 수 있는 MVP." />
  <style>
    /* subtle card hover */
    .card:hover { transform: translateY(-2px); }
  </style>
</head>
<body class="bg-slate-50 text-slate-900">
  <!-- Header -->
  <header class="sticky top-0 z-40 backdrop-blur bg-white/70 border-b border-slate-200">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between gap-3">
      <div class="flex items-center gap-2">
        <span class="text-xl">📰</span>
        <h1 class="text-lg sm:text-xl font-semibold">K‑Media Directory</h1>
      </div>
      <div class="hidden sm:flex items-center gap-3 text-xs text-slate-500">
        <button id="openDisclaimer" class="px-3 py-1.5 rounded-full bg-slate-900 text-white hover:bg-slate-800">안내/면책</button>
        <a href="#" id="downloadJson" class="px-3 py-1.5 rounded-full border border-slate-300 hover:bg-slate-100">데이터 내보내기</a>
        <label class="px-3 py-1.5 rounded-full border border-slate-300 hover:bg-slate-100 cursor-pointer">
          JSON 불러오기<input id="uploadJson" type="file" accept="application/json" class="hidden" />
        </label>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <!-- Controls -->
    <section class="mb-4 grid grid-cols-1 md:grid-cols-3 gap-3">
      <div class="col-span-2 flex flex-wrap items-center gap-2">
        <button data-filter="all" class="filter-btn px-3 py-1.5 rounded-full text-sm bg-slate-900 text-white">전체</button>
        <button data-filter="left" class="filter-btn px-3 py-1.5 rounded-full text-sm bg-rose-100 text-rose-700 border border-rose-200">좌</button>
        <button data-filter="center" class="filter-btn px-3 py-1.5 rounded-full text-sm bg-amber-100 text-amber-800 border border-amber-200">중</button>
        <button data-filter="right" class="filter-btn px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800 border border-indigo-200">우</button>
        <span class="text-xs text-slate-500 ml-2">* 분류는 <b>초기가설</b>이며 언제든 수정 가능합니다.</span>
      </div>
      <div class="flex items-center gap-2 justify-start md:justify-end">
        <input id="search" type="search" placeholder="언론사 검색" class="w-full md:w-64 px-3 py-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300"/>
        <select id="sort" class="px-3 py-2 rounded-lg border border-slate-300 text-sm">
          <option value="name">이름순</option>
          <option value="bias">성향순</option>
        </select>
      </div>
    </section>

    <!-- Stats -->
    <section id="stats" class="mb-4 text-sm text-slate-600"></section>

    <!-- Cards -->
    <section id="grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4"></section>

    <!-- How to edit -->
    <section class="mt-10 text-xs text-slate-500 leading-relaxed">
      <h2 class="font-semibold text-slate-700 mb-2">편집 방법(노코드)</h2>
      <ol class="list-decimal ml-4 space-y-1">
        <li>오른쪽 상단의 <b>데이터 내보내기</b>로 JSON을 다운로드합니다.</li>
        <li>메모장에서 성향(bias)을 <code>left|center|right</code> 중 하나로 원하는대로 수정합니다.</li>
        <li><b>JSON 불러오기</b> 버튼으로 업로드하면 즉시 반영됩니다(브라우저 로컬에만 저장).</li>
      </ol>
    </section>
  </main>

  <!-- Disclaimer Modal -->
  <div id="disclaimer" class="hidden fixed inset-0 z-50 items-center justify-center">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="relative bg-white max-w-xl mx-auto p-6 rounded-2xl shadow-xl">
      <h3 class="text-lg font-semibold mb-2">안내 및 면책</h3>
      <p class="text-sm text-slate-600 leading-relaxed">
        본 디렉터리의 성향 분류는 <b>초기가설</b>로, 학술적·교육적 참고용입니다. 특정 매체·기사·개인의 입장을 단정하거나 비방하려는 목적이 아닙니다.
        이견이 있으시면 우측 상단의 JSON 내보내기/불러오기 기능을 통해 직접 수정하여 사용하시길 권장합니다. 외부 공개 시에는 항상 출처를 확인하고 최신 정보로 업데이트하세요.
      </p>
      <div class="mt-4 flex justify-end gap-2">
        <button id="closeDisclaimer" class="px-3 py-1.5 rounded-lg border border-slate-300 hover:bg-slate-100">닫기</button>
      </div>
    </div>
  </div>

  <script>
    // ======= 데이터 세트 (초기가설) =======
    // 필요에 따라 freely 수정하세요.
    const DEFAULT_DATA = [
      { name: '연합뉴스', url: 'https://www.yna.co.kr/', bias: 'center', note: '통신사/속보 중심, 기준점으로 사용 권장' },
      { name: 'KBS', url: 'https://news.kbs.co.kr/', bias: 'center', note: '공영방송, 사안별 차이' },
      { name: 'MBC', url: 'https://imnews.imbc.com/', bias: 'center', note: '초기가설 — 데이터로 보정' },
      { name: 'SBS', url: 'https://news.sbs.co.kr/', bias: 'center', note: '초기가설 — 사안별 차이' },
      { name: '조선일보', url: 'https://www.chosun.com/', bias: 'right', note: '초기가설' },
      { name: '중앙일보', url: 'https://www.joongang.co.kr/', bias: 'right', note: '초기가설' },
      { name: '동아일보', url: 'https://www.donga.com/', bias: 'right', note: '초기가설' },
      { name: '한겨레', url: 'https://www.hani.co.kr/', bias: 'left', note: '초기가설' },
      { name: '경향신문', url: 'https://www.khan.co.kr/', bias: 'left', note: '초기가설' },
      { name: 'JTBC', url: 'https://news.jtbc.co.kr/', bias: 'center', note: '초기가설' },
      { name: 'YTN', url: 'https://www.ytn.co.kr/', bias: 'center', note: '초기가설' },
    ];

    // 로컬 저장 불러오기
    const loadLocal = () => {
      try { return JSON.parse(localStorage.getItem('mediaData')) || DEFAULT_DATA } catch { return DEFAULT_DATA }
    }
    const saveLocal = (data) => localStorage.setItem('mediaData', JSON.stringify(data))

    let mediaData = loadLocal();
    let state = { filter: 'all', query: '', sort: 'name' };

    const grid = document.getElementById('grid');
    const stats = document.getElementById('stats');

    function biasLabel(b){
      if(b==='left') return '좌';
      if(b==='center') return '중';
      if(b==='right') return '우';
      return b;
    }

    function biasChipCls(b){
      return {
        left: 'bg-rose-100 text-rose-700 border-rose-200',
        center: 'bg-amber-100 text-amber-800 border-amber-200',
        right: 'bg-indigo-100 text-indigo-800 border-indigo-200'
      }[b] || 'bg-slate-100 text-slate-700 border-slate-200'
    }

    function render(){
      let items = [...mediaData];
      // filter
      if(state.filter !== 'all') items = items.filter(x => x.bias === state.filter);
      // search
      if(state.query) items = items.filter(x => x.name.toLowerCase().includes(state.query.toLowerCase()));
      // sort
      if(state.sort === 'name') items.sort((a,b)=> a.name.localeCompare(b.name,'ko'));
      if(state.sort === 'bias') items.sort((a,b)=> a.bias.localeCompare(b.bias));

      // stats
      const counts = {
        left: mediaData.filter(x=>x.bias==='left').length,
        center: mediaData.filter(x=>x.bias==='center').length,
        right: mediaData.filter(x=>x.bias==='right').length,
      };
      stats.innerHTML = `총 <b>${mediaData.length}</b>개 매체 · 좌 <b>${counts.left}</b> · 중 <b>${counts.center}</b> · 우 <b>${counts.right}</b>`;

      // grid
      grid.innerHTML = items.map(item => `
        <article class="card bg-white rounded-2xl border border-slate-200 p-4 shadow-sm transition">
          <div class="flex items-start justify-between gap-3">
            <div>
              <h3 class="font-semibold text-slate-800">${item.name}</h3>
              <p class="mt-1 text-xs text-slate-500">${item.note || ''}</p>
            </div>
            <span class="inline-flex items-center gap-1 text-xs border px-2 py-1 rounded-full ${biasChipCls(item.bias)}">${biasLabel(item.bias)}<span class="opacity-60">(초기가설)</span></span>
          </div>
          <div class="mt-3 flex justify-between items-center">
            <a href="${item.url}" target="_blank" rel="noopener" class="px-3 py-2 rounded-lg bg-slate-900 text-white text-sm hover:bg-slate-800">언론사 방문</a>
            <button class="text-xs text-slate-500 hover:text-slate-700 underline" onclick='editItem("${item.name}")'>분류 편집</button>
          </div>
        </article>
      `).join('');
    }

    // Edit bias (simple prompt)
    window.editItem = function(name){
      const idx = mediaData.findIndex(x=>x.name===name);
      if(idx<0) return;
      const current = mediaData[idx].bias;
      const next = prompt(`${name}의 분류를 입력하세요 (left/center/right)`, current);
      if(!next) return;
      const ok = ['left','center','right'];
      if(!ok.includes(next)) { alert('left/center/right 중 하나로 입력하세요.'); return; }
      mediaData[idx].bias = next;
      saveLocal(mediaData);
      render();
    }

    // controls
    document.querySelectorAll('.filter-btn').forEach(btn=>{
      btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('ring-2','ring-slate-300'));
        btn.classList.add('ring-2','ring-slate-300');
        state.filter = btn.dataset.filter;
        render();
      });
    });

    document.getElementById('search').addEventListener('input', (e)=>{
      state.query = e.target.value.trim();
      render();
    });

    document.getElementById('sort').addEventListener('change', (e)=>{
      state.sort = e.target.value;
      render();
    });

    // disclaimer modal
    const modal = document.getElementById('disclaimer');
    document.getElementById('openDisclaimer').onclick = ()=>{ modal.classList.remove('hidden'); modal.classList.add('flex'); }
    document.getElementById('closeDisclaimer').onclick = ()=>{ modal.classList.add('hidden'); modal.classList.remove('flex'); }

    // export/import
    document.getElementById('downloadJson').addEventListener('click', (e)=>{
      e.preventDefault();
      const blob = new Blob([JSON.stringify(mediaData, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'media_directory.json'; a.click();
      URL.revokeObjectURL(url);
    });

    document.getElementById('uploadJson').addEventListener('change', (e)=>{
      const file = e.target.files[0]; if(!file) return;
      const reader = new FileReader();
      reader.onload = (ev)=>{
        try{
          const next = JSON.parse(ev.target.result);
          if(!Array.isArray(next)) throw new Error('배열 JSON이 필요합니다');
          mediaData = next; saveLocal(mediaData); render();
        }catch(err){ alert('JSON 형식 오류: ' + err.message); }
      };
      reader.readAsText(file, 'utf-8');
      e.target.value = '';
    });

    // init
    render();
  </script>
</body>
</html>
